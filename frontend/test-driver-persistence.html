<!DOCTYPE html>
<html lang=\"zh-CN\">
<head>
    <meta charset=\"UTF-8\">
    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">
    <title>å¸æœºç«¯çŠ¶æ€æŒä¹…åŒ–æµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .test-section {
            margin-bottom: 30px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .test-section h3 {
            margin-top: 0;
            color: #333;
        }
        button {
            background: #409EFF;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #66b1ff;
        }
        button.success {
            background: #67c23a;
        }
        button.warning {
            background: #e6a23c;
        }
        button.danger {
            background: #f56c6c;
        }
        .status-display {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
            font-family: monospace;
            font-size: 14px;
            white-space: pre-wrap;
        }
        .status-good {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }
        .status-error {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }
        .feature-list {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .test-scenario {
            background: #fff3e0;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
            border-left: 4px solid #ff9800;
        }
    </style>
</head>
<body>
    <div class=\"container\">
        <h1>ğŸš— å¸æœºç«¯çŠ¶æ€æŒä¹…åŒ–æµ‹è¯•</h1>
        <p>æµ‹è¯•å¸æœºç«¯åˆ‡æ¢é¡µé¢åè®¢å•çŠ¶æ€ä¸ä¼šæ¶ˆå¤±çš„åŠŸèƒ½</p>
    </div>

    <div class=\"container\">
        <div class=\"test-section\">
            <h3>1. åŠŸèƒ½ç‰¹æ€§</h3>
            <div class=\"feature-list\">
                <h4>âœ… å·²å®ç°çš„åŠŸèƒ½ï¼š</h4>
                <ul>
                    <li><strong>å¸æœºçŠ¶æ€æŒä¹…åŒ–</strong>: åœ¨çº¿çŠ¶æ€ã€ä½ç½®ä¿¡æ¯ã€æ”¶å…¥ç»Ÿè®¡</li>
                    <li><strong>è®¢å•çŠ¶æ€æŒä¹…åŒ–</strong>: å½“å‰è®¢å•ã€å¾…å¤„ç†è®¢å•é˜Ÿåˆ—</li>
                    <li><strong>å¯¼èˆªä¿¡æ¯æŒä¹…åŒ–</strong>: å¯¼èˆªçŠ¶æ€å’Œè·¯çº¿ä¿¡æ¯</li>
                    <li><strong>WebSocketè‡ªåŠ¨é‡è¿</strong>: é¡µé¢é‡æ–°åŠ è½½æ—¶è‡ªåŠ¨é‡æ–°å»ºç«‹è¿æ¥</li>
                    <li><strong>ç”¨æˆ·éš”ç¦»</strong>: ä¸åŒå¸æœºçš„çŠ¶æ€å®Œå…¨éš”ç¦»</li>
                    <li><strong>çŠ¶æ€è¿‡æœŸæœºåˆ¶</strong>: 24å°æ—¶åè‡ªåŠ¨æ¸…é™¤è¿‡æœŸçŠ¶æ€</li>
                </ul>
            </div>
        </div>

        <div class=\"test-section\">
            <h3>2. æ•°æ®ç»“æ„</h3>
            <div class=\"status-display\">
å¸æœºçŠ¶æ€æ•°æ®ç»“æ„:
{
  driverId: å¸æœºID,
  isOnline: åœ¨çº¿çŠ¶æ€,
  currentPosition: { lng: ç»åº¦, lat: çº¬åº¦ },
  todayEarnings: ä»Šæ—¥æ”¶å…¥,
  completedOrders: å®Œæˆè®¢å•æ•°,
  currentOrder: {
    id: è®¢å•ID,
    orderNumber: è®¢å•å·,
    status: è®¢å•çŠ¶æ€,
    pickupAddress: ä¸Šè½¦åœ°å€,
    destinationAddress: ç›®çš„åœ°åœ°å€,
    // ... å…¶ä»–è®¢å•ä¿¡æ¯
  },
  navigationInfo: å¯¼èˆªä¿¡æ¯,
  timestamp: ä¿å­˜æ—¶é—´æˆ³
}
            </div>
        </div>

        <div class=\"test-section\">
            <h3>3. æµ‹è¯•åœºæ™¯</h3>
            
            <div class=\"test-scenario\">
                <h4>åœºæ™¯1: å¸æœºä¸Šçº¿çŠ¶æ€æŒä¹…åŒ–</h4>
                <ol>
                    <li>å¸æœºç™»å½•å¹¶ä¸Šçº¿</li>
                    <li>åˆ‡æ¢åˆ°å…¶ä»–é¡µé¢æˆ–åˆ·æ–°é¡µé¢</li>
                    <li>é‡æ–°è¿›å…¥å¸æœºåœ°å›¾é¡µé¢</li>
                    <li>é¢„æœŸç»“æœ: å¸æœºä»ç„¶æ˜¾ç¤ºä¸ºåœ¨çº¿çŠ¶æ€</li>
                </ol>
            </div>

            <div class=\"test-scenario\">
                <h4>åœºæ™¯2: è¿›è¡Œä¸­è®¢å•æŒä¹…åŒ–</h4>
                <ol>
                    <li>å¸æœºæ¥å•å¹¶å¼€å§‹æ‰§è¡Œè®¢å•</li>
                    <li>è®¢å•çŠ¶æ€ä¸ºASSIGNEDã€PICKUPæˆ–IN_PROGRESS</li>
                    <li>åˆ‡æ¢é¡µé¢æˆ–åˆ·æ–°æµè§ˆå™¨</li>
                    <li>é‡æ–°è¿›å…¥å¸æœºåœ°å›¾é¡µé¢</li>
                    <li>é¢„æœŸç»“æœ: å½“å‰è®¢å•ä¿¡æ¯å®Œæ•´æ¢å¤ï¼ŒWebSocketè‡ªåŠ¨é‡è¿</li>
                </ol>
            </div>

            <div class=\"test-scenario\">
                <h4>åœºæ™¯3: å¾…å¤„ç†è®¢å•é˜Ÿåˆ—</h4>
                <ol>
                    <li>å¸æœºåœ¨çº¿ï¼Œæ”¶åˆ°å¤šä¸ªæ–°è®¢å•æ¨é€</li>
                    <li>è®¢å•åœ¨å€’è®¡æ—¶é˜Ÿåˆ—ä¸­</li>
                    <li>åˆ‡æ¢é¡µé¢åé‡æ–°è¿›å…¥</li>
                    <li>é¢„æœŸç»“æœ: å¾…å¤„ç†è®¢å•é˜Ÿåˆ—æ¢å¤ï¼ˆæ³¨æ„ï¼šå€’è®¡æ—¶ä¼šé‡ç½®ï¼‰</li>
                </ol>
            </div>

            <div class=\"test-scenario\">
                <h4>åœºæ™¯4: ç”¨æˆ·éš”ç¦»æµ‹è¯•</h4>
                <ol>
                    <li>å¸æœºAç™»å½•å¹¶è®¾ç½®çŠ¶æ€</li>
                    <li>ç™»å‡ºå¸æœºAï¼Œç™»å½•å¸æœºB</li>
                    <li>å¸æœºBè¿›å…¥åœ°å›¾é¡µé¢</li>
                    <li>é¢„æœŸç»“æœ: å¸æœºBçœ‹ä¸åˆ°å¸æœºAçš„ä»»ä½•çŠ¶æ€ä¿¡æ¯</li>
                </ol>
            </div>
        </div>

        <div class=\"test-section\">
            <h3>4. WebSocketé‡è¿æœºåˆ¶</h3>
            <div class=\"status-display\">
WebSocketé‡è¿é€»è¾‘:

1. é¡µé¢åŠ è½½æ—¶æ£€æŸ¥å¸æœºçŠ¶æ€
2. å¦‚æœå¸æœºåœ¨çº¿ OR æœ‰è¿›è¡Œä¸­çš„è®¢å•
3. è‡ªåŠ¨å»ºç«‹WebSocketè¿æ¥
4. è®¢é˜…å¸æœºä¸“ç”¨æ¶ˆæ¯é˜Ÿåˆ—: /user/{driverId}/queue/orders
5. å¤„ç†è®¢å•æ¨é€ã€çŠ¶æ€å˜åŒ–ç­‰æ¶ˆæ¯

è¿æ¥æ—¶æœº:
- å¸æœºä¸Šçº¿æ—¶
- é¡µé¢é‡æ–°åŠ è½½ä¸”æœ‰è¿›è¡Œä¸­è®¢å•æ—¶
- çŠ¶æ€æ¢å¤åæ£€æµ‹åˆ°éœ€è¦è¿æ¥æ—¶
            </div>
        </div>

        <div class=\"test-section\">
            <h3>5. è°ƒè¯•å‘½ä»¤</h3>
            <p>åœ¨æµè§ˆå™¨æ§åˆ¶å°æ‰§è¡Œä»¥ä¸‹å‘½ä»¤æ¥è°ƒè¯•çŠ¶æ€æŒä¹…åŒ–ï¼š</p>
            
            <div class=\"status-display\">
// æ£€æŸ¥localStorageä¸­çš„å¸æœºçŠ¶æ€
console.log(\"å¸æœºçŠ¶æ€:\", JSON.parse(localStorage.getItem('driverState') || '{}'));
console.log(\"å¸æœºç”¨æˆ·ID:\", localStorage.getItem('driverUserId'));

// æ£€æŸ¥å½“å‰storeçŠ¶æ€
if (window.driverStore) {
    console.log(\"åœ¨çº¿çŠ¶æ€:\", window.driverStore.isOnline);
    console.log(\"å½“å‰è®¢å•:\", window.driverStore.currentOrder);
    console.log(\"å¾…å¤„ç†è®¢å•:\", window.driverStore.pendingOrders);
}

// æ‰‹åŠ¨è§¦å‘çŠ¶æ€ä¿å­˜
if (window.driverStore) {
    window.driverStore.saveDriverState();
    console.log(\"çŠ¶æ€å·²ä¿å­˜\");
}

// æ‰‹åŠ¨è§¦å‘çŠ¶æ€æ¢å¤
if (window.driverStore) {
    window.driverStore.restoreDriverState();
    console.log(\"çŠ¶æ€å·²æ¢å¤\");
}

// æ¸…é™¤æ‰€æœ‰çŠ¶æ€ï¼ˆæµ‹è¯•ç”¨ï¼‰
if (window.driverStore) {
    window.driverStore.clearDriverState();
    console.log(\"çŠ¶æ€å·²æ¸…é™¤\");
}
            </div>
            <button onclick=\"copyToClipboard(this.previousElementSibling.textContent)\">å¤åˆ¶è°ƒè¯•å‘½ä»¤</button>
        </div>

        <div class=\"test-section\">
            <h3>6. é¢„æœŸæ•ˆæœ</h3>
            <div class=\"status-display status-good\">
âœ… å¸æœºç«¯çŠ¶æ€æŒä¹…åŒ–åº”è¯¥å®ç°ï¼š

1. é¡µé¢åˆ·æ–°åå¸æœºåœ¨çº¿çŠ¶æ€ä¿æŒ
2. è¿›è¡Œä¸­çš„è®¢å•ä¿¡æ¯å®Œæ•´æ¢å¤
3. å¯¼èˆªçŠ¶æ€å’Œè·¯çº¿ä¿¡æ¯æ¢å¤
4. WebSocketè¿æ¥è‡ªåŠ¨é‡æ–°å»ºç«‹
5. ä»Šæ—¥æ”¶å…¥å’Œå®Œæˆè®¢å•æ•°ä¿æŒ
6. ä¸åŒå¸æœºä¹‹é—´çŠ¶æ€å®Œå…¨éš”ç¦»
7. è¿‡æœŸçŠ¶æ€è‡ªåŠ¨æ¸…ç†ï¼ˆ24å°æ—¶ï¼‰

å¦‚æœä»¥ä¸ŠåŠŸèƒ½æ­£å¸¸å·¥ä½œï¼Œè¯´æ˜å¸æœºç«¯çŠ¶æ€æŒä¹…åŒ–å®ç°æˆåŠŸï¼
            </div>
        </div>
    </div>

    <div class=\"container\">
        <h3>ğŸ”§ æŠ€æœ¯å®ç°</h3>
        <div class=\"status-display\">
æŠ€æœ¯æ¶æ„:

1. Pinia Store (stores/driver.js)
   - é›†ä¸­ç®¡ç†å¸æœºçŠ¶æ€
   - æä¾›çŠ¶æ€æŒä¹…åŒ–æ–¹æ³•
   - å¤„ç†WebSocketè¿æ¥ç®¡ç†

2. localStorageæŒä¹…åŒ–
   - ä¿å­˜å¸æœºçŠ¶æ€åˆ°æœ¬åœ°å­˜å‚¨
   - ç”¨æˆ·IDéš”ç¦»æœºåˆ¶
   - çŠ¶æ€è¿‡æœŸæ£€æŸ¥

3. ç»„ä»¶é›†æˆ (DriverMap.vue)
   - ä½¿ç”¨computedå±æ€§ç»‘å®šstoreçŠ¶æ€
   - onMountedæ—¶æ¢å¤çŠ¶æ€
   - onUnmountedæ—¶æ¸…ç†èµ„æº

4. WebSocketç®¡ç†
   - è‡ªåŠ¨é‡è¿æœºåˆ¶
   - æ¶ˆæ¯è·¯ç”±å’Œå¤„ç†
   - å…¨å±€å‡½æ•°é€šä¿¡æœºåˆ¶
        </div>
    </div>

    <script>
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                alert('è°ƒè¯•å‘½ä»¤å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
            }).catch(err => {
                console.error('å¤åˆ¶å¤±è´¥:', err);
                const textArea = document.createElement('textarea');
                textArea.value = text;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                alert('è°ƒè¯•å‘½ä»¤å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
            });
        }

        window.onload = function() {
            console.log('ğŸš— å¸æœºç«¯çŠ¶æ€æŒä¹…åŒ–æµ‹è¯•é¡µé¢å·²åŠ è½½');
            console.log('è¯·æŒ‰ç…§æµ‹è¯•åœºæ™¯è¿›è¡ŒåŠŸèƒ½éªŒè¯');
        };
    </script>
</body>
</html>"