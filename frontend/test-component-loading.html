<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>组件加载测试</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://unpkg.com/element-plus@2.4.4/dist/index.full.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/element-plus@2.4.4/dist/index.css">
    <style>
        body {
            margin: 0;
            font-family: 'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;
            padding: 20px;
        }
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        .component-preview {
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            padding: 16px;
            background: white;
            margin-top: 15px;
        }
        .mock-data {
            background: #f8fafc;
            padding: 10px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 12px;
            margin-bottom: 15px;
        }
    </style>
</head>
<body>
    <div id="app">
        <h1>司机端组件加载测试</h1>
        
        <!-- 订单组件测试 -->
        <div class="test-section">
            <h2>1. 司机订单组件测试</h2>
            <div class="mock-data">
                模拟数据: {{ JSON.stringify(mockOrders.slice(0, 1), null, 2) }}
            </div>
            
            <div class="component-preview">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h3>我的订单</h3>
                    <div style="display: flex; gap: 10px;">
                        <el-select v-model="statusFilter" placeholder="筛选状态" clearable style="width: 150px;">
                            <el-option label="全部" value="" />
                            <el-option label="已完成" value="COMPLETED" />
                            <el-option label="已取消" value="CANCELLED" />
                        </el-select>
                        <el-button>
                            <el-icon><Refresh /></el-icon>
                            刷新
                        </el-button>
                    </div>
                </div>
                
                <div v-if="mockOrders.length === 0">
                    <el-empty description="暂无订单记录" />
                </div>
                
                <div v-else>
                    <el-card v-for="order in mockOrders" :key="order.id" style="margin-bottom: 16px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; padding-bottom: 12px; border-bottom: 1px solid #f0f0f0;">
                            <div style="display: flex; align-items: center; gap: 8px;">
                                <span style="font-weight: 600; color: #333; font-size: 16px;">#{{ order.orderNumber }}</span>
                                <el-tag :type="getStatusTagType(order.status)" size="small">
                                    {{ getStatusText(order.status) }}
                                </el-tag>
                                <el-tag v-if="order.orderType === 'RESERVATION'" type="warning" size="small">
                                    预约单
                                </el-tag>
                            </div>
                            <div style="color: #666; font-size: 14px;">{{ formatDateTime(order.createdAt) }}</div>
                        </div>
                        
                        <div style="display: flex; gap: 24px;">
                            <div style="flex: 1; display: flex; flex-direction: column; gap: 8px;">
                                <div style="display: flex; align-items: center; gap: 8px;">
                                    <el-icon style="font-size: 16px; color: #67c23a;"><LocationFilled /></el-icon>
                                    <span style="color: #333; font-size: 14px;">{{ order.pickupAddress }}</span>
                                </div>
                                <div style="width: 2px; height: 20px; background: linear-gradient(to bottom, #67c23a, #e6a23c); margin-left: 7px;"></div>
                                <div style="display: flex; align-items: center; gap: 8px;">
                                    <el-icon style="font-size: 16px; color: #e6a23c;"><Location /></el-icon>
                                    <span style="color: #333; font-size: 14px;">{{ order.destinationAddress }}</span>
                                </div>
                            </div>
                            
                            <div style="flex: 0 0 200px; display: flex; flex-direction: column; gap: 6px;">
                                <div style="display: flex; justify-content: space-between; align-items: center; font-size: 14px;">
                                    <span style="color: #666;">距离:</span>
                                    <span style="color: #333; font-weight: 500;">{{ order.estimatedDistance.toFixed(1) }}km</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; align-items: center; font-size: 14px;">
                                    <span style="color: #666;">时长:</span>
                                    <span style="color: #333; font-weight: 500;">{{ order.estimatedDuration }}分钟</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; align-items: center; font-size: 14px;">
                                    <span style="color: #666;">费用:</span>
                                    <span style="color: #f56c6c; font-weight: 600;">¥{{ order.actualFare.toFixed(2) }}</span>
                                </div>
                            </div>
                        </div>
                    </el-card>
                </div>
            </div>
        </div>
        
        <!-- 收入统计组件测试 -->
        <div class="test-section">
            <h2>2. 收入统计组件测试</h2>
            <div class="mock-data">
                模拟收入数据: {{ JSON.stringify(mockEarnings, null, 2) }}
            </div>
            
            <div class="component-preview">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h3>收入统计</h3>
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <el-date-picker
                            v-model="selectedMonth"
                            type="month"
                            placeholder="选择月份"
                            format="YYYY年MM月"
                            value-format="YYYY-MM">
                        </el-date-picker>
                        <el-button type="primary">
                            <el-icon><Refresh /></el-icon>
                            刷新
                        </el-button>
                    </div>
                </div>
                
                <!-- 收入概览卡片 -->
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 20px;">
                    <el-card style="height: 120px;">
                        <div style="display: flex; align-items: center; height: 100%;">
                            <div style="width: 60px; height: 60px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 15px; font-size: 24px; color: white; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                                <el-icon><Money /></el-icon>
                            </div>
                            <div style="flex: 1;">
                                <div style="font-size: 24px; font-weight: bold; color: #333; margin-bottom: 5px;">¥{{ mockEarnings.totalEarnings.toFixed(2) }}</div>
                                <div style="font-size: 14px; color: #666;">总收入</div>
                            </div>
                        </div>
                    </el-card>
                    
                    <el-card style="height: 120px;">
                        <div style="display: flex; align-items: center; height: 100%;">
                            <div style="width: 60px; height: 60px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 15px; font-size: 24px; color: white; background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                                <el-icon><Document /></el-icon>
                            </div>
                            <div style="flex: 1;">
                                <div style="font-size: 24px; font-weight: bold; color: #333; margin-bottom: 5px;">{{ mockEarnings.totalOrders }}</div>
                                <div style="font-size: 14px; color: #666;">完成订单</div>
                            </div>
                        </div>
                    </el-card>
                    
                    <el-card style="height: 120px;">
                        <div style="display: flex; align-items: center; height: 100%;">
                            <div style="width: 60px; height: 60px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 15px; font-size: 24px; color: white; background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                                <el-icon><TrendCharts /></el-icon>
                            </div>
                            <div style="flex: 1;">
                                <div style="font-size: 24px; font-weight: bold; color: #333; margin-bottom: 5px;">¥{{ mockEarnings.averageEarnings.toFixed(2) }}</div>
                                <div style="font-size: 14px; color: #666;">平均单价</div>
                            </div>
                        </div>
                    </el-card>
                    
                    <el-card style="height: 120px;">
                        <div style="display: flex; align-items: center; height: 100%;">
                            <div style="width: 60px; height: 60px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 15px; font-size: 24px; color: white; background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);">
                                <el-icon><Location /></el-icon>
                            </div>
                            <div style="flex: 1;">
                                <div style="font-size: 24px; font-weight: bold; color: #333; margin-bottom: 5px;">{{ mockEarnings.totalDistance.toFixed(1) }}km</div>
                                <div style="font-size: 14px; color: #666;">总里程</div>
                            </div>
                        </div>
                    </el-card>
                </div>
                
                <!-- 订单明细表格 -->
                <el-card>
                    <template #header>
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span>{{ selectedMonth }} 月收入明细</span>
                            <span style="font-size: 14px; color: #666; font-weight: 500;">
                                共 {{ mockEarnings.totalOrders }} 单，总收入 ¥{{ mockEarnings.totalEarnings.toFixed(2) }}
                            </span>
                        </div>
                    </template>
                    
                    <el-table :data="mockOrders" stripe style="width: 100%">
                        <el-table-column prop="orderNumber" label="订单号" width="150">
                            <template #default="{ row }">
                                #{{ row.orderNumber }}
                            </template>
                        </el-table-column>
                        <el-table-column prop="createdAt" label="完成时间" width="180">
                            <template #default="{ row }">
                                {{ formatDateTime(row.completionTime || row.createdAt) }}
                            </template>
                        </el-table-column>
                        <el-table-column label="路线" min-width="200">
                            <template #default="{ row }">
                                <div style="display: flex; flex-direction: column; gap: 4px;">
                                    <div style="display: flex; align-items: center; gap: 6px; font-size: 13px;">
                                        <el-icon style="color: #67c23a;"><LocationFilled /></el-icon>
                                        {{ row.pickupAddress }}
                                    </div>
                                    <div style="display: flex; align-items: center; gap: 6px; font-size: 13px;">
                                        <el-icon style="color: #e6a23c;"><Location /></el-icon>
                                        {{ row.destinationAddress }}
                                    </div>
                                </div>
                            </template>
                        </el-table-column>
                        <el-table-column prop="estimatedDistance" label="距离(km)" width="100" align="center">
                            <template #default="{ row }">
                                {{ row.estimatedDistance.toFixed(1) }}
                            </template>
                        </el-table-column>
                        <el-table-column prop="actualFare" label="收入" width="120" align="center">
                            <template #default="{ row }">
                                <span style="color: #67C23A; font-weight: bold;">¥{{ row.actualFare.toFixed(2) }}</span>
                            </template>
                        </el-table-column>
                        <el-table-column label="订单类型" width="100" align="center">
                            <template #default="{ row }">
                                <el-tag v-if="row.orderType === 'RESERVATION'" type="warning" size="small">
                                    预约单
                                </el-tag>
                                <el-tag v-else type="primary" size="small">
                                    即时单
                                </el-tag>
                            </template>
                        </el-table-column>
                    </el-table>
                </el-card>
            </div>
        </div>
        
        <div style="margin-top: 30px; padding: 20px; background: #f0f9ff; border-radius: 8px;">
            <h3 style="color: #0c4a6e; margin-bottom: 10px;">测试结果</h3>
            <p style="color: #0c4a6e; margin: 5px 0;">✅ Element Plus 图标正常显示</p>
            <p style="color: #0c4a6e; margin: 5px 0;">✅ 组件样式正常渲染</p>
            <p style="color: #0c4a6e; margin: 5px 0;">✅ 数据绑定正常工作</p>
            <p style="color: #0c4a6e; margin: 5px 0;">✅ 表格和卡片组件正常显示</p>
            <p style="color: #0c4a6e; margin: 5px 0;">如果以上都正常显示，说明组件本身没有问题，可能是路由或权限相关的问题。</p>
        </div>
    </div>

    <script>
        const { createApp, ref, reactive } = Vue;
        const { ElMessage } = ElementPlus;
        
        // 导入图标
        const { Refresh, Loading, LocationFilled, Location, Money, Document, TrendCharts } = ElementPlusIconsVue;

        createApp({
            components: {
                Refresh, Loading, LocationFilled, Location, Money, Document, TrendCharts
            },
            setup() {
                const statusFilter = ref('');
                const selectedMonth = ref(new Date().toISOString().slice(0, 7));
                
                // 模拟订单数据
                const mockOrders = ref([
                    {
                        id: 1,
                        orderNumber: 'ORD20250805001',
                        status: 'COMPLETED',
                        orderType: 'IMMEDIATE',
                        pickupAddress: '北京市朝阳区三里屯SOHO',
                        destinationAddress: '北京市海淀区中关村软件园',
                        estimatedDistance: 12.5,
                        estimatedDuration: 35,
                        actualFare: 45.80,
                        createdAt: '2025-08-05T10:30:00',
                        completionTime: '2025-08-05T11:05:00'
                    },
                    {
                        id: 2,
                        orderNumber: 'ORD20250805002',
                        status: 'COMPLETED',
                        orderType: 'RESERVATION',
                        pickupAddress: '北京市东城区王府井大街',
                        destinationAddress: '北京首都国际机场T3航站楼',
                        estimatedDistance: 28.3,
                        estimatedDuration: 55,
                        actualFare: 89.50,
                        createdAt: '2025-08-05T14:15:00',
                        completionTime: '2025-08-05T15:10:00'
                    }
                ]);
                
                // 模拟收入统计数据
                const mockEarnings = reactive({
                    totalEarnings: 1256.80,
                    totalOrders: 28,
                    averageEarnings: 44.89,
                    totalDistance: 342.6
                });

                // 状态相关方法
                const getStatusTagType = (status) => {
                    const statusMap = {
                        'COMPLETED': 'success',
                        'CANCELLED': 'danger',
                        'IN_PROGRESS': 'primary',
                        'ASSIGNED': 'warning',
                        'PICKUP': 'info',
                        'PENDING': 'warning',
                        'SCHEDULED': 'info'
                    };
                    return statusMap[status] || 'info';
                };

                const getStatusText = (status) => {
                    const statusMap = {
                        'SCHEDULED': '已预约',
                        'PENDING': '待接单',
                        'ASSIGNED': '已接单',
                        'PICKUP': '已到达',
                        'IN_PROGRESS': '进行中',
                        'COMPLETED': '已完成',
                        'CANCELLED': '已取消'
                    };
                    return statusMap[status] || status;
                };

                const formatDateTime = (dateTime) => {
                    if (!dateTime) return '--';
                    return new Date(dateTime).toLocaleString('zh-CN', {
                        year: 'numeric',
                        month: '2-digit',
                        day: '2-digit',
                        hour: '2-digit',
                        minute: '2-digit'
                    });
                };

                return {
                    statusFilter,
                    selectedMonth,
                    mockOrders,
                    mockEarnings,
                    getStatusTagType,
                    getStatusText,
                    formatDateTime
                };
            }
        }).use(ElementPlus).mount('#app');
    </script>
</body>
</html>