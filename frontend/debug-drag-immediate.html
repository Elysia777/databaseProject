<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ‹–æ‹½é—®é¢˜å³æ—¶è°ƒè¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .debug-code {
            background: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            margin: 10px 0;
            overflow-x: auto;
        }
        .step {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
            border-left: 4px solid #2196f3;
        }
        .warning {
            background: #fff3e0;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
            border-left: 4px solid #ff9800;
        }
        .success {
            background: #e8f5e8;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
            border-left: 4px solid #4caf50;
        }
        button {
            background: #409EFF;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #66b1ff;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸš€ æ‹–æ‹½é—®é¢˜å³æ—¶è°ƒè¯•</h1>
        <p>ç›´æ¥åœ¨æµè§ˆå™¨æ§åˆ¶å°æ‰§è¡Œè¿™äº›å‘½ä»¤æ¥è°ƒè¯•æ‹–æ‹½é—®é¢˜</p>
    </div>

    <div class="container">
        <div class="step">
            <h3>æ­¥éª¤1: æ£€æŸ¥å½“å‰çŠ¶æ€</h3>
            <p>åœ¨æµè§ˆå™¨æ§åˆ¶å°æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p>
            <div class="debug-code">
// æ£€æŸ¥æ ‡è®°æ˜¯å¦å­˜åœ¨
console.log("pickupMarkerå­˜åœ¨:", !!window.pickupMarker);

// æ£€æŸ¥æ ‡è®°çš„æ‹–æ‹½çŠ¶æ€
if (window.pickupMarker) {
    console.log("å½“å‰æ‹–æ‹½çŠ¶æ€:", window.pickupMarker.getDraggable());
    console.log("æ ‡è®°å…‰æ ‡:", window.pickupMarker.getCursor());
    console.log("æ ‡è®°æ ‡é¢˜:", window.pickupMarker.getTitle());
}

// æ£€æŸ¥è®¢å•çŠ¶æ€
console.log("å½“å‰è®¢å•:", window.currentOrder?.value);
console.log("è®¢å•çŠ¶æ€:", window.orderStatus?.value);
            </div>
            <button onclick="copyToClipboard(this.nextElementSibling.textContent)">å¤åˆ¶ä»£ç </button>
        </div>

        <div class="step">
            <h3>æ­¥éª¤2: å¼ºåˆ¶å¯ç”¨æ‹–æ‹½</h3>
            <p>å¦‚æœæ ‡è®°å­˜åœ¨ä½†ä¸èƒ½æ‹–æ‹½ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤å¼ºåˆ¶å¯ç”¨ï¼š</p>
            <div class="debug-code">
// å¼ºåˆ¶è®¾ç½®ä¸ºå¯æ‹–æ‹½
if (window.pickupMarker) {
    window.pickupMarker.setDraggable(true);
    window.pickupMarker.setCursor("move");
    window.pickupMarker.setTitle("æ‹–æ‹½è°ƒæ•´ä¸Šè½¦ä½ç½®");
    console.log("âœ… å·²å¼ºåˆ¶å¯ç”¨æ‹–æ‹½");
} else {
    console.log("âŒ æ ‡è®°ä¸å­˜åœ¨");
}
            </div>
            <button onclick="copyToClipboard(this.nextElementSibling.textContent)">å¤åˆ¶ä»£ç </button>
        </div>

        <div class="step">
            <h3>æ­¥éª¤3: æ£€æŸ¥äº‹ä»¶ç›‘å¬å™¨</h3>
            <p>æ£€æŸ¥æ ‡è®°ä¸Šæ˜¯å¦æœ‰æ­£ç¡®çš„äº‹ä»¶ç›‘å¬å™¨ï¼š</p>
            <div class="debug-code">
// æ£€æŸ¥äº‹ä»¶ç›‘å¬å™¨ï¼ˆChrome DevToolsï¼‰
if (window.pickupMarker) {
    console.log("æ ‡è®°å¯¹è±¡:", window.pickupMarker);
    
    // å¦‚æœæœ‰getEventListenerså‡½æ•°ï¼ˆChrome DevToolsï¼‰
    if (typeof getEventListeners === 'function') {
        console.log("äº‹ä»¶ç›‘å¬å™¨:", getEventListeners(window.pickupMarker));
    }
    
    // æ‰‹åŠ¨æµ‹è¯•æ‹–æ‹½äº‹ä»¶
    window.pickupMarker.on('dragstart', () => console.log('æ‹–æ‹½å¼€å§‹'));
    window.pickupMarker.on('dragend', () => console.log('æ‹–æ‹½ç»“æŸ'));
}
            </div>
            <button onclick="copyToClipboard(this.nextElementSibling.textContent)">å¤åˆ¶ä»£ç </button>
        </div>

        <div class="step">
            <h3>æ­¥éª¤4: æ£€æŸ¥CSSå¹²æ‰°</h3>
            <p>æ£€æŸ¥æ˜¯å¦æœ‰CSSæ ·å¼å½±å“æ‹–æ‹½ï¼š</p>
            <div class="debug-code">
// æ£€æŸ¥åœ°å›¾å®¹å™¨çš„CSS
const mapContainer = document.getElementById('mapContainer');
if (mapContainer) {
    const styles = window.getComputedStyle(mapContainer);
    console.log("åœ°å›¾å®¹å™¨æ ·å¼:");
    console.log("pointer-events:", styles.pointerEvents);
    console.log("user-select:", styles.userSelect);
    console.log("touch-action:", styles.touchAction);
}

// æ£€æŸ¥æ˜¯å¦æœ‰å…¨å±€CSSå½±å“
console.log("bodyæ ·å¼:");
const bodyStyles = window.getComputedStyle(document.body);
console.log("user-select:", bodyStyles.userSelect);
console.log("touch-action:", bodyStyles.touchAction);
            </div>
            <button onclick="copyToClipboard(this.nextElementSibling.textContent)">å¤åˆ¶ä»£ç </button>
        </div>

        <div class="warning">
            <h3>âš ï¸ å¸¸è§é—®é¢˜æ’æŸ¥</h3>
            <ul>
                <li><strong>è®¢å•çŠ¶æ€é—®é¢˜</strong>: å¦‚æœcurrentOrder.valueä¸ä¸ºnullï¼Œæ‹–æ‹½ä¼šè¢«ç¦ç”¨</li>
                <li><strong>æ—¶åºé—®é¢˜</strong>: updatePickupMarkerDraggable()å¯èƒ½åœ¨é”™è¯¯çš„æ—¶æœºè¢«è°ƒç”¨</li>
                <li><strong>CSSå†²çª</strong>: user-select: none æˆ– pointer-events: none ä¼šå½±å“æ‹–æ‹½</li>
                <li><strong>åœ°å›¾ç‰ˆæœ¬é—®é¢˜</strong>: ä¸åŒç‰ˆæœ¬çš„é«˜å¾·åœ°å›¾APIå¯èƒ½æœ‰ä¸åŒçš„æ‹–æ‹½è¡Œä¸º</li>
            </ul>
        </div>

        <div class="step">
            <h3>æ­¥éª¤5: ä¸´æ—¶ä¿®å¤æ–¹æ¡ˆ</h3>
            <p>å¦‚æœä¸Šè¿°æ£€æŸ¥å‘ç°é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä¸´æ—¶ä¿®å¤ï¼š</p>
            <div class="debug-code">
// ä¸´æ—¶ä¿®å¤ï¼šå¿½ç•¥è®¢å•çŠ¶æ€ï¼Œå¼ºåˆ¶å¯ç”¨æ‹–æ‹½
if (window.pickupMarker) {
    // ä¿å­˜åŸå§‹çš„updatePickupMarkerDraggableå‡½æ•°
    window.originalUpdatePickupMarkerDraggable = window.updatePickupMarkerDraggable;
    
    // é‡å†™å‡½æ•°ï¼Œå§‹ç»ˆå¯ç”¨æ‹–æ‹½
    window.updatePickupMarkerDraggable = function() {
        if (window.pickupMarker) {
            window.pickupMarker.setDraggable(true);
            window.pickupMarker.setCursor("move");
            window.pickupMarker.setTitle("æ‹–æ‹½è°ƒæ•´ä¸Šè½¦ä½ç½®");
            console.log("ğŸ”§ ä¸´æ—¶ä¿®å¤ï¼šå¼ºåˆ¶å¯ç”¨æ‹–æ‹½");
        }
    };
    
    // ç«‹å³æ‰§è¡Œ
    window.updatePickupMarkerDraggable();
}
            </div>
            <button onclick="copyToClipboard(this.nextElementSibling.textContent)">å¤åˆ¶ä»£ç </button>
        </div>

        <div class="success">
            <h3>âœ… å¦‚æœæ‹–æ‹½æ­£å¸¸å·¥ä½œ</h3>
            <p>å¦‚æœé€šè¿‡ä¸Šè¿°æ­¥éª¤æ‹–æ‹½å¼€å§‹æ­£å¸¸å·¥ä½œï¼Œè¯´æ˜é—®é¢˜ç¡®å®åœ¨äºï¼š</p>
            <ul>
                <li>è®¢å•çŠ¶æ€å¯¼è‡´æ‹–æ‹½è¢«ç¦ç”¨</li>
                <li>updatePickupMarkerDraggableå‡½æ•°çš„è°ƒç”¨æ—¶æœº</li>
                <li>éœ€è¦ä¿®æ”¹é€»è¾‘ï¼Œåœ¨æ²¡æœ‰è®¢å•æ—¶å§‹ç»ˆå…è®¸æ‹–æ‹½</li>
            </ul>
        </div>
    </div>

    <div class="container">
        <h3>ğŸ”§ æ°¸ä¹…ä¿®å¤å»ºè®®</h3>
        <p>åŸºäºè°ƒè¯•ç»“æœï¼Œä»¥ä¸‹æ˜¯å¯èƒ½çš„æ°¸ä¹…ä¿®å¤æ–¹æ¡ˆï¼š</p>
        
        <div class="step">
            <h4>æ–¹æ¡ˆ1: ä¿®æ”¹æ‹–æ‹½é€»è¾‘</h4>
            <div class="debug-code">
// åœ¨PassengerMap.vueä¸­ä¿®æ”¹updatePickupMarkerDraggableå‡½æ•°
const updatePickupMarkerDraggable = () => {
  if (pickupMarker) {
    // åªæœ‰åœ¨è®¢å•çŠ¶æ€ä¸ºè¿›è¡Œä¸­æ—¶æ‰ç¦ç”¨æ‹–æ‹½
    const isDraggable = !currentOrder.value || 
                       !['ASSIGNED', 'PICKUP', 'IN_PROGRESS'].includes(orderStatus.value);
    
    pickupMarker.setDraggable(isDraggable);
    pickupMarker.setCursor(isDraggable ? "move" : "default");
    pickupMarker.setTitle(isDraggable ? "æ‹–æ‹½è°ƒæ•´ä¸Šè½¦ä½ç½®" : "ä¸Šè½¦ç‚¹");
  }
};
            </div>
        </div>

        <div class="step">
            <h4>æ–¹æ¡ˆ2: å»¶è¿Ÿæ›´æ–°æ—¶æœº</h4>
            <div class="debug-code">
// åœ¨æ ‡è®°åˆ›å»ºåæ›´é•¿æ—¶é—´å»¶è¿Ÿ
setTimeout(() => {
    updatePickupMarkerDraggable();
}, 500); // å¢åŠ åˆ°500ms

// æˆ–è€…ç›‘å¬åœ°å›¾å®Œå…¨åŠ è½½äº‹ä»¶
map.on('complete', () => {
    updatePickupMarkerDraggable();
});
            </div>
        </div>
    </div>

    <script>
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                alert('ä»£ç å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
            }).catch(err => {
                console.error('å¤åˆ¶å¤±è´¥:', err);
                // å¤‡ç”¨æ–¹æ¡ˆ
                const textArea = document.createElement('textarea');
                textArea.value = text;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                alert('ä»£ç å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
            });
        }

        // é¡µé¢åŠ è½½æ—¶çš„è¯´æ˜
        window.onload = function() {
            console.log('ğŸš€ æ‹–æ‹½è°ƒè¯•å·¥å…·å·²åŠ è½½');
            console.log('è¯·æŒ‰ç…§é¡µé¢ä¸Šçš„æ­¥éª¤åœ¨æ§åˆ¶å°ä¸­æ‰§è¡Œè°ƒè¯•å‘½ä»¤');
        };
    </script>
</body>
</html>"