<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç½‘çº¦è½¦ç®¡ç†åå°</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://unpkg.com/element-plus/dist/index.full.js"></script>
    <script src="https://unpkg.com/echarts@5.4.3/dist/echarts.min.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/element-plus/dist/index.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            background: #f5f7fa;
        }
        
        .admin-layout {
            display: flex;
            height: 100vh;
        }
        
        .sidebar {
            width: 250px;
            background: #304156;
            color: white;
            overflow-y: auto;
        }
        
        .sidebar-header {
            padding: 20px;
            background: #263445;
            text-align: center;
            border-bottom: 1px solid #3a4a5c;
        }
        
        .sidebar-header h2 {
            font-size: 18px;
            font-weight: 600;
        }
        
        .sidebar-menu {
            padding: 0;
        }
        
        .menu-item {
            display: block;
            padding: 15px 20px;
            color: #bfcbd9;
            text-decoration: none;
            border-bottom: 1px solid #3a4a5c;
            transition: all 0.3s;
            cursor: pointer;
        }
        
        .menu-item:hover,
        .menu-item.active {
            background: #409eff;
            color: white;
        }
        
        .menu-item i {
            margin-right: 10px;
            width: 16px;
        }
        
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        .header {
            height: 60px;
            background: white;
            border-bottom: 1px solid #e6e6e6;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            box-shadow: 0 1px 4px rgba(0,21,41,.08);
        }
        
        .header-title {
            font-size: 18px;
            font-weight: 600;
            color: #333;
        }
        
        .header-user {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .content-area {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
        }
        
        .dashboard-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.1);
            border-left: 4px solid #409eff;
        }
        
        .stat-card.success {
            border-left-color: #67c23a;
        }
        
        .stat-card.warning {
            border-left-color: #e6a23c;
        }
        
        .stat-card.danger {
            border-left-color: #f56c6c;
        }
        
        .stat-card h3 {
            font-size: 14px;
            color: #666;
            margin-bottom: 10px;
        }
        
        .stat-card .number {
            font-size: 28px;
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }
        
        .stat-card .change {
            font-size: 12px;
            color: #999;
        }
        
        .chart-container {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        
        .chart-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 20px;
            color: #333;
        }
        
        .chart {
            width: 100%;
            height: 300px;
        }
        
        .data-table {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.1);
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: #999;
        }
        
        .error {
            text-align: center;
            padding: 40px;
            color: #f56c6c;
        }
        
        @media (max-width: 768px) {
            .admin-layout {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                height: auto;
            }
            
            .dashboard-cards {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div id="app">
        <div class="admin-layout">
            <!-- ä¾§è¾¹æ  -->
            <div class="sidebar">
                <div class="sidebar-header">
                    <h2>ğŸš— ç½‘çº¦è½¦ç®¡ç†åå°</h2>
                </div>
                <nav class="sidebar-menu">
                    <a class="menu-item" :class="{active: currentView === 'dashboard'}" @click="setView('dashboard')">
                        <i>ğŸ“Š</i> æ•°æ®æ¦‚è§ˆ
                    </a>
                    <a class="menu-item" :class="{active: currentView === 'users'}" @click="setView('users')">
                        <i>ğŸ‘¥</i> ç”¨æˆ·ç®¡ç†
                    </a>
                    <a class="menu-item" :class="{active: currentView === 'orders'}" @click="setView('orders')">
                        <i>ğŸ“‹</i> è®¢å•ç®¡ç†
                    </a>
                    <a class="menu-item" :class="{active: currentView === 'reviews'}" @click="setView('reviews')">
                        <i>â­</i> è¯„ä»·ç®¡ç†
                    </a>
                    <a class="menu-item" :class="{active: currentView === 'statistics'}" @click="setView('statistics')">
                        <i>ğŸ“ˆ</i> æ•°æ®ç»Ÿè®¡
                    </a>
                    <a class="menu-item" :class="{active: currentView === 'system'}" @click="setView('system')">
                        <i>âš™ï¸</i> ç³»ç»Ÿç›‘æ§
                    </a>
                    <a class="menu-item" :class="{active: currentView === 'settings'}" @click="setView('settings')">
                        <i>ğŸ”§</i> ç³»ç»Ÿè®¾ç½®
                    </a>
                </nav>
            </div>
            
            <!-- ä¸»å†…å®¹åŒº -->
            <div class="main-content">
                <!-- é¡¶éƒ¨å¯¼èˆª -->
                <div class="header">
                    <div class="header-title">{{ getViewTitle() }}</div>
                    <div class="header-user">
                        <span>ç®¡ç†å‘˜ï¼š{{ adminInfo.realName || 'Admin' }}</span>
                        <el-button size="small" @click="logout">é€€å‡ºç™»å½•</el-button>
                    </div>
                </div>
                
                <!-- å†…å®¹åŒºåŸŸ -->
                <div class="content-area">
                    <!-- ä»ªè¡¨æ¿è§†å›¾ -->
                    <div v-if="currentView === 'dashboard'">
                        <div class="dashboard-cards">
                            <div class="stat-card">
                                <h3>æ€»ç”¨æˆ·æ•°</h3>
                                <div class="number">{{ stats.totalUsers }}</div>
                                <div class="change">è¾ƒæ˜¨æ—¥ +{{ stats.userGrowth }}</div>
                            </div>
                            <div class="stat-card success">
                                <h3>åœ¨çº¿å¸æœº</h3>
                                <div class="number">{{ stats.onlineDrivers }}</div>
                                <div class="change">å½“å‰åœ¨çº¿</div>
                            </div>
                            <div class="stat-card warning">
                                <h3>ä»Šæ—¥è®¢å•</h3>
                                <div class="number">{{ stats.todayOrders }}</div>
                                <div class="change">è¾ƒæ˜¨æ—¥ +{{ stats.orderGrowth }}%</div>
                            </div>
                            <div class="stat-card danger">
                                <h3>ä»Šæ—¥æ”¶å…¥</h3>
                                <div class="number">Â¥{{ stats.todayRevenue }}</div>
                                <div class="change">è¾ƒæ˜¨æ—¥ +{{ stats.revenueGrowth }}%</div>
                            </div>
                        </div>
                        
                        <div class="chart-container">
                            <div class="chart-title">è®¢å•è¶‹åŠ¿</div>
                            <div ref="orderChart" class="chart"></div>
                        </div>
                        
                        <div class="chart-container">
                            <div class="chart-title">ç”¨æˆ·åˆ†å¸ƒ</div>
                            <div ref="userChart" class="chart"></div>
                        </div>
                    </div>
                    
                    <!-- ç”¨æˆ·ç®¡ç†è§†å›¾ -->
                    <div v-if="currentView === 'users'">
                        <div class="data-table">
                            <div style="margin-bottom: 20px; display: flex; justify-content: space-between; align-items: center;">
                                <h3>ç”¨æˆ·åˆ—è¡¨</h3>
                                <div>
                                    <el-input v-model="userSearch" placeholder="æœç´¢ç”¨æˆ·" style="width: 200px; margin-right: 10px;" />
                                    <el-select v-model="userTypeFilter" placeholder="ç”¨æˆ·ç±»å‹" style="width: 120px;">
                                        <el-option label="å…¨éƒ¨" value="" />
                                        <el-option label="ä¹˜å®¢" value="PASSENGER" />
                                        <el-option label="å¸æœº" value="DRIVER" />
                                        <el-option label="ç®¡ç†å‘˜" value="ADMIN" />
                                    </el-select>
                                </div>
                            </div>
                            
                            <el-table :data="filteredUsers" style="width: 100%" v-loading="loading.users">
                                <el-table-column prop="id" label="ID" width="80" />
                                <el-table-column prop="username" label="ç”¨æˆ·å" width="120" />
                                <el-table-column prop="realName" label="çœŸå®å§“å" width="120" />
                                <el-table-column prop="phone" label="æ‰‹æœºå·" width="130" />
                                <el-table-column prop="userType" label="ç”¨æˆ·ç±»å‹" width="100">
                                    <template #default="scope">
                                        <el-tag :type="getUserTypeColor(scope.row.userType)">
                                            {{ getUserTypeText(scope.row.userType) }}
                                        </el-tag>
                                    </template>
                                </el-table-column>
                                <el-table-column prop="status" label="çŠ¶æ€" width="100">
                                    <template #default="scope">
                                        <el-tag :type="scope.row.status === 'ACTIVE' ? 'success' : 'danger'">
                                            {{ scope.row.status === 'ACTIVE' ? 'æ­£å¸¸' : 'ç¦ç”¨' }}
                                        </el-tag>
                                    </template>
                                </el-table-column>
                                <el-table-column prop="createdAt" label="æ³¨å†Œæ—¶é—´" width="180" />
                                <el-table-column label="æ“ä½œ" width="200">
                                    <template #default="scope">
                                        <el-button size="small" @click="viewUser(scope.row)">æŸ¥çœ‹</el-button>
                                        <el-button 
                                            size="small" 
                                            :type="scope.row.status === 'ACTIVE' ? 'danger' : 'success'"
                                            @click="toggleUserStatus(scope.row)">
                                            {{ scope.row.status === 'ACTIVE' ? 'ç¦ç”¨' : 'å¯ç”¨' }}
                                        </el-button>
                                    </template>
                                </el-table-column>
                            </el-table>
                        </div>
                    </div>
                    
                    <!-- è®¢å•ç®¡ç†è§†å›¾ -->
                    <div v-if="currentView === 'orders'">
                        <div class="data-table">
                            <div style="margin-bottom: 20px; display: flex; justify-content: space-between; align-items: center;">
                                <h3>è®¢å•åˆ—è¡¨</h3>
                                <div>
                                    <el-select v-model="orderStatusFilter" placeholder="è®¢å•çŠ¶æ€" style="width: 120px;">
                                        <el-option label="å…¨éƒ¨" value="" />
                                        <el-option label="å¾…æ¥å•" value="PENDING" />
                                        <el-option label="è¿›è¡Œä¸­" value="IN_PROGRESS" />
                                        <el-option label="å·²å®Œæˆ" value="COMPLETED" />
                                        <el-option label="å·²å–æ¶ˆ" value="CANCELLED" />
                                    </el-select>
                                </div>
                            </div>
                            
                            <el-table :data="orders" style="width: 100%" v-loading="loading.orders">
                                <el-table-column prop="id" label="è®¢å•å·" width="100" />
                                <el-table-column prop="passengerName" label="ä¹˜å®¢" width="120" />
                                <el-table-column prop="driverName" label="å¸æœº" width="120" />
                                <el-table-column prop="startAddress" label="èµ·ç‚¹" width="200" />
                                <el-table-column prop="endAddress" label="ç»ˆç‚¹" width="200" />
                                <el-table-column prop="status" label="çŠ¶æ€" width="100">
                                    <template #default="scope">
                                        <el-tag :type="getOrderStatusColor(scope.row.status)">
                                            {{ getOrderStatusText(scope.row.status) }}
                                        </el-tag>
                                    </template>
                                </el-table-column>
                                <el-table-column prop="totalFare" label="è´¹ç”¨" width="100">
                                    <template #default="scope">
                                        Â¥{{ scope.row.totalFare }}
                                    </template>
                                </el-table-column>
                                <el-table-column prop="createdAt" label="åˆ›å»ºæ—¶é—´" width="180" />
                                <el-table-column label="æ“ä½œ" width="120">
                                    <template #default="scope">
                                        <el-button size="small" @click="viewOrder(scope.row)">æŸ¥çœ‹è¯¦æƒ…</el-button>
                                    </template>
                                </el-table-column>
                            </el-table>
                        </div>
                    </div>
                    
                    <!-- å…¶ä»–è§†å›¾çš„å ä½ç¬¦ -->
                    <div v-if="['reviews', 'statistics', 'system', 'settings'].includes(currentView)">
                        <div class="loading">
                            <h3>{{ getViewTitle() }}</h3>
                            <p>æ­¤åŠŸèƒ½æ­£åœ¨å¼€å‘ä¸­...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const { createApp, ref, reactive, computed, onMounted, nextTick } = Vue;
        const { ElMessage, ElMessageBox } = ElementPlus;

        createApp({
            setup() {
                const API_BASE = 'http://localhost:8080';
                
                // çŠ¶æ€ç®¡ç†
                const currentView = ref('dashboard');
                const adminInfo = reactive({
                    username: 'admin',
                    realName: 'ç³»ç»Ÿç®¡ç†å‘˜'
                });
                
                // ç»Ÿè®¡æ•°æ®
                const stats = reactive({
                    totalUsers: 0,
                    onlineDrivers: 0,
                    todayOrders: 0,
                    todayRevenue: 0,
                    userGrowth: 0,
                    orderGrowth: 0,
                    revenueGrowth: 0
                });
                
                // æ•°æ®åˆ—è¡¨
                const users = ref([]);
                const orders = ref([]);
                
                // ç­›é€‰æ¡ä»¶
                const userSearch = ref('');
                const userTypeFilter = ref('');
                const orderStatusFilter = ref('');
                
                // åŠ è½½çŠ¶æ€
                const loading = reactive({
                    users: false,
                    orders: false,
                    stats: false
                });
                
                // å›¾è¡¨å¼•ç”¨
                const orderChart = ref(null);
                const userChart = ref(null);
                
                // è®¡ç®—å±æ€§
                const filteredUsers = computed(() => {
                    let filtered = users.value;
                    
                    if (userSearch.value) {
                        filtered = filtered.filter(user => 
                            user.username.includes(userSearch.value) ||
                            (user.realName && user.realName.includes(userSearch.value)) ||
                            (user.phone && user.phone.includes(userSearch.value))
                        );
                    }
                    
                    if (userTypeFilter.value) {
                        filtered = filtered.filter(user => user.userType === userTypeFilter.value);
                    }
                    
                    return filtered;
                });
                
                // æ–¹æ³•
                const setView = (view) => {
                    currentView.value = view;
                    
                    // æ ¹æ®è§†å›¾åŠ è½½ç›¸åº”æ•°æ®
                    switch(view) {
                        case 'dashboard':
                            loadDashboardData();
                            break;
                        case 'users':
                            loadUsers();
                            break;
                        case 'orders':
                            loadOrders();
                            break;
                    }
                };
                
                const getViewTitle = () => {
                    const titles = {
                        dashboard: 'æ•°æ®æ¦‚è§ˆ',
                        users: 'ç”¨æˆ·ç®¡ç†',
                        orders: 'è®¢å•ç®¡ç†',
                        reviews: 'è¯„ä»·ç®¡ç†',
                        statistics: 'æ•°æ®ç»Ÿè®¡',
                        system: 'ç³»ç»Ÿç›‘æ§',
                        settings: 'ç³»ç»Ÿè®¾ç½®'
                    };
                    return titles[currentView.value] || 'ç®¡ç†åå°';
                };
                
                const loadDashboardData = async () => {
                    loading.stats = true;
                    try {
                        // åŠ è½½ç»Ÿè®¡æ•°æ®
                        await Promise.all([
                            loadStats(),
                            loadCharts()
                        ]);
                    } catch (error) {
                        console.error('åŠ è½½ä»ªè¡¨æ¿æ•°æ®å¤±è´¥:', error);
                        ElMessage.error('åŠ è½½æ•°æ®å¤±è´¥');
                    } finally {
                        loading.stats = false;
                    }
                };
                
                const loadStats = async () => {
                    try {
                        // åŠ è½½ç”¨æˆ·ç»Ÿè®¡
                        const usersResponse = await fetch(`${API_BASE}/api/users`);
                        if (usersResponse.ok) {
                            const usersData = await usersResponse.json();
                            if (usersData.success) {
                                stats.totalUsers = usersData.data.length;
                                stats.onlineDrivers = usersData.data.filter(u => u.userType === 'DRIVER' && u.status === 'ACTIVE').length;
                            }
                        }
                        
                        // åŠ è½½è®¢å•ç»Ÿè®¡
                        const ordersResponse = await fetch(`${API_BASE}/api/orders`);
                        if (ordersResponse.ok) {
                            const ordersData = await ordersResponse.json();
                            if (ordersData.success) {
                                const today = new Date().toISOString().split('T')[0];
                                const todayOrders = ordersData.data.filter(o => o.createdAt && o.createdAt.startsWith(today));
                                stats.todayOrders = todayOrders.length;
                                stats.todayRevenue = todayOrders.reduce((sum, order) => sum + (order.totalFare || 0), 0);
                            }
                        }
                        
                        // æ¨¡æ‹Ÿå¢é•¿æ•°æ®
                        stats.userGrowth = Math.floor(Math.random() * 20) + 5;
                        stats.orderGrowth = Math.floor(Math.random() * 15) + 3;
                        stats.revenueGrowth = Math.floor(Math.random() * 25) + 8;
                        
                    } catch (error) {
                        console.error('åŠ è½½ç»Ÿè®¡æ•°æ®å¤±è´¥:', error);
                    }
                };
                
                const loadCharts = async () => {
                    await nextTick();
                    
                    // è®¢å•è¶‹åŠ¿å›¾
                    if (orderChart.value) {
                        const chart1 = echarts.init(orderChart.value);
                        const option1 = {
                            title: { text: 'è¿‘7å¤©è®¢å•è¶‹åŠ¿' },
                            tooltip: { trigger: 'axis' },
                            xAxis: {
                                type: 'category',
                                data: ['å‘¨ä¸€', 'å‘¨äºŒ', 'å‘¨ä¸‰', 'å‘¨å››', 'å‘¨äº”', 'å‘¨å…­', 'å‘¨æ—¥']
                            },
                            yAxis: { type: 'value' },
                            series: [{
                                data: [120, 132, 101, 134, 90, 230, 210],
                                type: 'line',
                                smooth: true,
                                itemStyle: { color: '#409eff' }
                            }]
                        };
                        chart1.setOption(option1);
                    }
                    
                    // ç”¨æˆ·åˆ†å¸ƒå›¾
                    if (userChart.value) {
                        const chart2 = echarts.init(userChart.value);
                        const option2 = {
                            title: { text: 'ç”¨æˆ·ç±»å‹åˆ†å¸ƒ' },
                            tooltip: { trigger: 'item' },
                            series: [{
                                type: 'pie',
                                radius: '50%',
                                data: [
                                    { value: stats.totalUsers * 0.7, name: 'ä¹˜å®¢' },
                                    { value: stats.totalUsers * 0.25, name: 'å¸æœº' },
                                    { value: stats.totalUsers * 0.05, name: 'ç®¡ç†å‘˜' }
                                ]
                            }]
                        };
                        chart2.setOption(option2);
                    }
                };
                
                const loadUsers = async () => {
                    loading.users = true;
                    try {
                        const response = await fetch(`${API_BASE}/api/users`);
                        const data = await response.json();
                        
                        if (data.success) {
                            users.value = data.data.map(user => ({
                                ...user,
                                createdAt: user.createdAt ? new Date(user.createdAt).toLocaleString() : '-'
                            }));
                        } else {
                            ElMessage.error('åŠ è½½ç”¨æˆ·æ•°æ®å¤±è´¥');
                        }
                    } catch (error) {
                        console.error('åŠ è½½ç”¨æˆ·å¤±è´¥:', error);
                        ElMessage.error('ç½‘ç»œé”™è¯¯');
                    } finally {
                        loading.users = false;
                    }
                };
                
                const loadOrders = async () => {
                    loading.orders = true;
                    try {
                        const response = await fetch(`${API_BASE}/api/orders`);
                        const data = await response.json();
                        
                        if (data.success) {
                            orders.value = data.data.map(order => ({
                                ...order,
                                createdAt: order.createdAt ? new Date(order.createdAt).toLocaleString() : '-'
                            }));
                        } else {
                            ElMessage.error('åŠ è½½è®¢å•æ•°æ®å¤±è´¥');
                        }
                    } catch (error) {
                        console.error('åŠ è½½è®¢å•å¤±è´¥:', error);
                        ElMessage.error('ç½‘ç»œé”™è¯¯');
                    } finally {
                        loading.orders = false;
                    }
                };
                
                const getUserTypeColor = (type) => {
                    const colors = {
                        'PASSENGER': '',
                        'DRIVER': 'success',
                        'ADMIN': 'warning'
                    };
                    return colors[type] || '';
                };
                
                const getUserTypeText = (type) => {
                    const texts = {
                        'PASSENGER': 'ä¹˜å®¢',
                        'DRIVER': 'å¸æœº',
                        'ADMIN': 'ç®¡ç†å‘˜'
                    };
                    return texts[type] || type;
                };
                
                const getOrderStatusColor = (status) => {
                    const colors = {
                        'PENDING': 'warning',
                        'IN_PROGRESS': 'primary',
                        'COMPLETED': 'success',
                        'CANCELLED': 'danger'
                    };
                    return colors[status] || '';
                };
                
                const getOrderStatusText = (status) => {
                    const texts = {
                        'PENDING': 'å¾…æ¥å•',
                        'IN_PROGRESS': 'è¿›è¡Œä¸­',
                        'COMPLETED': 'å·²å®Œæˆ',
                        'CANCELLED': 'å·²å–æ¶ˆ'
                    };
                    return texts[status] || status;
                };
                
                const viewUser = (user) => {
                    ElMessageBox.alert(
                        `ç”¨æˆ·ID: ${user.id}\nç”¨æˆ·å: ${user.username}\nçœŸå®å§“å: ${user.realName || '-'}\næ‰‹æœºå·: ${user.phone || '-'}\né‚®ç®±: ${user.email || '-'}\nç”¨æˆ·ç±»å‹: ${getUserTypeText(user.userType)}\nçŠ¶æ€: ${user.status === 'ACTIVE' ? 'æ­£å¸¸' : 'ç¦ç”¨'}\næ³¨å†Œæ—¶é—´: ${user.createdAt}`,
                        'ç”¨æˆ·è¯¦æƒ…',
                        { confirmButtonText: 'ç¡®å®š' }
                    );
                };
                
                const viewOrder = (order) => {
                    ElMessageBox.alert(
                        `è®¢å•å·: ${order.id}\nä¹˜å®¢: ${order.passengerName || '-'}\nå¸æœº: ${order.driverName || '-'}\nèµ·ç‚¹: ${order.startAddress || '-'}\nç»ˆç‚¹: ${order.endAddress || '-'}\nçŠ¶æ€: ${getOrderStatusText(order.status)}\nè´¹ç”¨: Â¥${order.totalFare || 0}\nåˆ›å»ºæ—¶é—´: ${order.createdAt}`,
                        'è®¢å•è¯¦æƒ…',
                        { confirmButtonText: 'ç¡®å®š' }
                    );
                };
                
                const toggleUserStatus = async (user) => {
                    const newStatus = user.status === 'ACTIVE' ? 'BANNED' : 'ACTIVE';
                    const action = newStatus === 'ACTIVE' ? 'å¯ç”¨' : 'ç¦ç”¨';
                    
                    try {
                        await ElMessageBox.confirm(`ç¡®å®šè¦${action}ç”¨æˆ· ${user.username} å—ï¼Ÿ`, 'ç¡®è®¤æ“ä½œ');
                        
                        // è¿™é‡Œåº”è¯¥è°ƒç”¨APIæ›´æ–°ç”¨æˆ·çŠ¶æ€
                        // const response = await fetch(`${API_BASE}/api/users/${user.id}/status`, {
                        //     method: 'PUT',
                        //     headers: { 'Content-Type': 'application/json' },
                        //     body: JSON.stringify({ status: newStatus })
                        // });
                        
                        // æ¨¡æ‹Ÿæ›´æ–°æˆåŠŸ
                        user.status = newStatus;
                        ElMessage.success(`ç”¨æˆ·${action}æˆåŠŸ`);
                        
                    } catch (error) {
                        if (error !== 'cancel') {
                            ElMessage.error(`${action}ç”¨æˆ·å¤±è´¥`);
                        }
                    }
                };
                
                const logout = () => {
                    ElMessageBox.confirm('ç¡®å®šè¦é€€å‡ºç™»å½•å—ï¼Ÿ', 'ç¡®è®¤é€€å‡º')
                        .then(() => {
                            // æ¸…é™¤ç™»å½•çŠ¶æ€
                            localStorage.removeItem('adminToken');
                            // è·³è½¬åˆ°ç™»å½•é¡µ
                            window.location.href = 'admin-login.html';
                        })
                        .catch(() => {});
                };
                
                // åˆå§‹åŒ–
                onMounted(() => {
                    // æ£€æŸ¥ç™»å½•çŠ¶æ€
                    const token = localStorage.getItem('adminToken');
                    if (!token) {
                        window.location.href = 'admin-login.html';
                        return;
                    }
                    
                    // åŠ è½½é»˜è®¤æ•°æ®
                    loadDashboardData();
                });
                
                return {
                    currentView,
                    adminInfo,
                    stats,
                    users,
                    orders,
                    userSearch,
                    userTypeFilter,
                    orderStatusFilter,
                    loading,
                    orderChart,
                    userChart,
                    filteredUsers,
                    setView,
                    getViewTitle,
                    getUserTypeColor,
                    getUserTypeText,
                    getOrderStatusColor,
                    getOrderStatusText,
                    viewUser,
                    viewOrder,
                    toggleUserStatus,
                    logout
                };
            }
        }).use(ElementPlus).mount('#app');
    </script>
</body>
</html>