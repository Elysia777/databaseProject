<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¶ˆæ¯æµè°ƒè¯•å·¥å…·</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .debug-section {
            margin-bottom: 20px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .debug-section h3 {
            margin-top: 0;
            color: #333;
        }
        button {
            background: #409EFF;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #66b1ff;
        }
        button.success {
            background: #67c23a;
        }
        button.danger {
            background: #f56c6c;
        }
        .status-display {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
            font-family: monospace;
            font-size: 14px;
            white-space: pre-wrap;
        }
        .status-good {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }
        .status-error {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }
        .flow-step {
            background: #e3f2fd;
            padding: 10px;
            margin: 5px 0;
            border-left: 4px solid #2196f3;
            border-radius: 3px;
        }
        .flow-step.success {
            background: #e8f5e8;
            border-left-color: #4caf50;
        }
        .flow-step.error {
            background: #ffebee;
            border-left-color: #f44336;
        }
        .checklist {
            background: #fff3e0;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .checklist-item {
            margin: 8px 0;
            padding: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ” æ¶ˆæ¯æµè°ƒè¯•å·¥å…·</h1>
        <p>è¯Šæ–­ä¹˜å®¢ç«¯ä¸ºä»€ä¹ˆæ¥æ”¶ä¸åˆ°å¸æœºçŠ¶æ€å˜åŒ–æ¶ˆæ¯</p>
    </div>

    <div class="container">
        <div class="debug-section">
            <h3>1. æ¶ˆæ¯æµç¨‹æ£€æŸ¥</h3>
            <button onclick="checkMessageFlow()">æ£€æŸ¥æ¶ˆæ¯æµç¨‹</button>
            
            <div id="messageFlowStatus" class="status-display">
                ç‚¹å‡»æŒ‰é’®æ£€æŸ¥æ¶ˆæ¯æµç¨‹...
            </div>
        </div>

        <div class="debug-section">
            <h3>2. WebSocketè¿æ¥çŠ¶æ€</h3>
            <button onclick="checkWebSocketStatus()">æ£€æŸ¥è¿æ¥çŠ¶æ€</button>
            <button onclick="simulateReconnect()">æ¨¡æ‹Ÿé‡è¿</button>
            
            <div id="websocketStatus" class="status-display">
                ç‚¹å‡»æŒ‰é’®æ£€æŸ¥WebSocketçŠ¶æ€...
            </div>
        </div>

        <div class="debug-section">
            <h3>3. ç”¨æˆ·IDåŒ¹é…æ£€æŸ¥</h3>
            <button onclick="checkUserIdMatching()">æ£€æŸ¥ç”¨æˆ·ID</button>
            
            <div id="userIdStatus" class="status-display">
                ç‚¹å‡»æŒ‰é’®æ£€æŸ¥ç”¨æˆ·IDåŒ¹é…...
            </div>
        </div>

        <div class="debug-section">
            <h3>4. è®¢é˜…è·¯å¾„éªŒè¯</h3>
            <button onclick="verifySubscriptionPath()">éªŒè¯è®¢é˜…è·¯å¾„</button>
            
            <div id="subscriptionStatus" class="status-display">
                ç‚¹å‡»æŒ‰é’®éªŒè¯è®¢é˜…è·¯å¾„...
            </div>
        </div>

        <div class="debug-section">
            <h3>5. æ¶ˆæ¯å¤„ç†é“¾æ£€æŸ¥</h3>
            <button onclick="checkMessageHandling()">æ£€æŸ¥æ¶ˆæ¯å¤„ç†</button>
            
            <div id="handlingStatus" class="status-display">
                ç‚¹å‡»æŒ‰é’®æ£€æŸ¥æ¶ˆæ¯å¤„ç†é“¾...
            </div>
        </div>

        <div class="debug-section">
            <h3>6. é—®é¢˜è¯Šæ–­å’Œå»ºè®®</h3>
            <button onclick="diagnoseIssues()">è¯Šæ–­é—®é¢˜</button>
            
            <div id="diagnosisResult" class="checklist">
                <h4>è¯Šæ–­ç»“æœ:</h4>
                <div id="diagnosisItems">ç‚¹å‡»è¯Šæ–­æŒ‰é’®å¼€å§‹...</div>
            </div>
        </div>
    </div>

    <div class="container">
        <h3>ğŸ“‹ è°ƒè¯•æ—¥å¿—</h3>
        <div id="debugLog" style="background: #f8f9fa; padding: 15px; border-radius: 5px; font-family: monospace; font-size: 12px; max-height: 400px; overflow-y: auto;"></div>
    </div>

    <script>
        function log(message, type = 'info') {
            const logDiv = document.getElementById('debugLog');
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = `[${timestamp}] ${type.toUpperCase()}: ${message}\\n`;
            logDiv.textContent += logEntry;
            logDiv.scrollTop = logDiv.scrollHeight;
            console.log(logEntry);
        }

        function checkMessageFlow() {
            const statusDiv = document.getElementById('messageFlowStatus');
            let content = '';

            const flowSteps = [
                {
                    step: '1. å¸æœºç‚¹å‡»"åˆ°è¾¾èµ·å§‹ç‚¹"',
                    backend: 'OrderController.confirmArrival()',
                    action: 'æ›´æ–°è®¢å•çŠ¶æ€ä¸ºPICKUP',
                    notification: 'notifyPassengerOrderStatusChange(passengerId, orderId, "PICKUP", message)',
                    status: 'success'
                },
                {
                    step: '2. åç«¯å‘é€WebSocketæ¶ˆæ¯',
                    backend: 'WebSocketNotificationService.notifyPassengerOrderStatusChange()',
                    action: 'messagingTemplate.convertAndSendToUser(passengerId, "/queue/orders", notification)',
                    notification: 'å‘é€åˆ° /user/{passengerId}/queue/orders',
                    status: 'success'
                },
                {
                    step: '3. å‰ç«¯WebSocketæ¥æ”¶',
                    backend: 'stompClient.subscribe("/user/{passengerId}/queue/orders")',
                    action: 'æ¥æ”¶æ¶ˆæ¯å¹¶è§£æJSON',
                    notification: 'handleOrderUpdate(data)',
                    status: 'error'
                },
                {
                    step: '4. å…¨å±€storeå¤„ç†',
                    backend: 'handleOrderUpdate() in order.js',
                    action: 'handleOrderStatusChange(data)',
                    notification: 'æ›´æ–°è®¢å•çŠ¶æ€ï¼Œæ˜¾ç¤ºUIæ¶ˆæ¯',
                    status: 'error'
                },
                {
                    step: '5. åœ°å›¾ç»„ä»¶æ›´æ–°',
                    backend: 'window.handleMapOrderUpdate(data)',
                    action: 'handleStatusChange() in PassengerMap.vue',
                    notification: 'æ›´æ–°åœ°å›¾å…ƒç´ å’ŒUI',
                    status: 'error'
                }
            ];

            flowSteps.forEach((step, index) => {
                const stepClass = step.status === 'success' ? 'flow-step success' : 'flow-step error';
                const statusIcon = step.status === 'success' ? 'âœ…' : 'âŒ';
                
                content += `<div class="${stepClass}">
                    ${statusIcon} ${step.step}<br>
                    ğŸ“ ä½ç½®: ${step.backend}<br>
                    ğŸ”§ æ“ä½œ: ${step.action}<br>
                    ğŸ“¨ é€šçŸ¥: ${step.notification}
                </div>`;
            });

            content += `<div class="flow-step error">
                âŒ é—®é¢˜ç‚¹: æ­¥éª¤3-5å¯èƒ½å­˜åœ¨é—®é¢˜<br>
                ğŸ” éœ€è¦æ£€æŸ¥: WebSocketè¿æ¥ã€ç”¨æˆ·IDåŒ¹é…ã€æ¶ˆæ¯å¤„ç†é“¾
            </div>`;

            statusDiv.innerHTML = content;
            log('æ¶ˆæ¯æµç¨‹æ£€æŸ¥å®Œæˆ');
        }

        function checkWebSocketStatus() {
            const statusDiv = document.getElementById('websocketStatus');
            let status = 'WebSocketè¿æ¥çŠ¶æ€æ£€æŸ¥:\\n\\n';

            // æ¨¡æ‹Ÿæ£€æŸ¥WebSocketçŠ¶æ€
            const checks = [
                { name: 'WebSocketè¿æ¥', status: 'éœ€è¦æ£€æŸ¥', details: 'æ£€æŸ¥stompClient.connectedçŠ¶æ€' },
                { name: 'è®¢é˜…çŠ¶æ€', status: 'éœ€è¦æ£€æŸ¥', details: 'æ£€æŸ¥æ˜¯å¦æˆåŠŸè®¢é˜…/user/{id}/queue/orders' },
                { name: 'ç”¨æˆ·è®¤è¯', status: 'éœ€è¦æ£€æŸ¥', details: 'æ£€æŸ¥ç”¨æˆ·æ˜¯å¦æ­£ç¡®è®¤è¯' },
                { name: 'æ¶ˆæ¯æ¥æ”¶', status: 'éœ€è¦æ£€æŸ¥', details: 'æ£€æŸ¥æ˜¯å¦èƒ½æ¥æ”¶åˆ°ä»»ä½•æ¶ˆæ¯' }
            ];

            checks.forEach(check => {
                status += `ğŸ” ${check.name}: ${check.status}\\n`;
                status += `   è¯¦æƒ…: ${check.details}\\n\\n`;
            });

            status += 'ğŸ’¡ è°ƒè¯•å»ºè®®:\\n';
            status += '1. åœ¨æµè§ˆå™¨æ§åˆ¶å°æŸ¥çœ‹WebSocketè¿æ¥æ—¥å¿—\\n';
            status += '2. æ£€æŸ¥Networkæ ‡ç­¾é¡µçš„WebSocketè¿æ¥\\n';
            status += '3. ç¡®è®¤ç”¨æˆ·IDå’Œè®¢é˜…è·¯å¾„æ­£ç¡®\\n';
            status += '4. æ£€æŸ¥åç«¯æ˜¯å¦çœŸçš„å‘é€äº†æ¶ˆæ¯';

            statusDiv.textContent = status;
            statusDiv.className = 'status-display';
            log('WebSocketçŠ¶æ€æ£€æŸ¥å®Œæˆ');
        }

        function checkUserIdMatching() {
            const statusDiv = document.getElementById('userIdStatus');
            let status = 'ç”¨æˆ·IDåŒ¹é…æ£€æŸ¥:\\n\\n';

            // æ¨¡æ‹Ÿç”¨æˆ·IDæ£€æŸ¥
            status += 'ğŸ†” ç”¨æˆ·IDåŒ¹é…æµç¨‹:\\n\\n';
            
            status += '1. å‰ç«¯è·å–ç”¨æˆ·ID:\\n';
            status += '   - userStore.user.passengerId æˆ– userStore.user.id\\n';
            status += '   - è½¬æ¢ä¸ºå­—ç¬¦ä¸²: passengerId.toString()\\n';
            status += '   - è®¢é˜…è·¯å¾„: /user/{passengerId}/queue/orders\\n\\n';
            
            status += '2. åç«¯å‘é€æ¶ˆæ¯:\\n';
            status += '   - order.getPassengerId()\\n';
            status += '   - è½¬æ¢ä¸ºå­—ç¬¦ä¸²: passengerId.toString()\\n';
            status += '   - å‘é€è·¯å¾„: /user/{passengerId}/queue/orders\\n\\n';
            
            status += 'â— å¯èƒ½çš„é—®é¢˜:\\n';
            status += '1. å‰ç«¯å’Œåç«¯çš„ç”¨æˆ·IDç±»å‹ä¸åŒ¹é…\\n';
            status += '2. ç”¨æˆ·IDä¸ºnullæˆ–undefined\\n';
            status += '3. å­—ç¬¦ä¸²è½¬æ¢é—®é¢˜\\n';
            status += '4. è®¢å•ä¸­çš„passengerIdä¸å½“å‰ç”¨æˆ·ä¸åŒ¹é…\\n\\n';
            
            status += 'ğŸ”§ è°ƒè¯•æ–¹æ³•:\\n';
            status += '1. åœ¨å‰ç«¯æ‰“å°: console.log("å‰ç«¯ç”¨æˆ·ID:", passengerId)\\n';
            status += '2. åœ¨åç«¯æ‰“å°: System.out.println("åç«¯ç”¨æˆ·ID: " + passengerId)\\n';
            status += '3. æ£€æŸ¥è®¢å•è¡¨ä¸­çš„passenger_idå­—æ®µ\\n';
            status += '4. ç¡®è®¤WebSocketè¿æ¥æ—¶ä½¿ç”¨çš„ç”¨æˆ·ID';

            statusDiv.textContent = status;
            statusDiv.className = 'status-display';
            log('ç”¨æˆ·IDåŒ¹é…æ£€æŸ¥å®Œæˆ');
        }

        function verifySubscriptionPath() {
            const statusDiv = document.getElementById('subscriptionStatus');
            let status = 'è®¢é˜…è·¯å¾„éªŒè¯:\\n\\n';

            status += 'ğŸ“¡ WebSocketè®¢é˜…è·¯å¾„åˆ†æ:\\n\\n';
            
            status += 'å‰ç«¯è®¢é˜…:\\n';
            status += '  è·¯å¾„: /user/{passengerId}/queue/orders\\n';
            status += '  ç¤ºä¾‹: /user/1/queue/orders\\n';
            status += '  ä»£ç : stompClient.subscribe(`/user/${passengerId}/queue/orders`)\\n\\n';
            
            status += 'åç«¯å‘é€:\\n';
            status += '  æ–¹æ³•: messagingTemplate.convertAndSendToUser()\\n';
            status += '  ç”¨æˆ·: passengerId.toString()\\n';
            status += '  ç›®æ ‡: "/queue/orders"\\n';
            status += '  å®é™…è·¯å¾„: /user/{passengerId}/queue/orders\\n\\n';
            
            status += 'âœ… è·¯å¾„åŒ¹é…åˆ†æ:\\n';
            status += 'å‰ç«¯è®¢é˜…å’Œåç«¯å‘é€çš„è·¯å¾„åº”è¯¥æ˜¯åŒ¹é…çš„\\n\\n';
            
            status += 'ğŸ” å¯èƒ½çš„é—®é¢˜:\\n';
            status += '1. ç”¨æˆ·IDä¸ä¸€è‡´å¯¼è‡´è·¯å¾„ä¸åŒ¹é…\\n';
            status += '2. WebSocketè¿æ¥åœ¨è®¢é˜…å‰æ–­å¼€\\n';
            status += '3. Spring Securityé…ç½®é—®é¢˜\\n';
            status += '4. STOMPåè®®é…ç½®é—®é¢˜\\n\\n';
            
            status += 'ğŸ› ï¸ éªŒè¯æ–¹æ³•:\\n';
            status += '1. åœ¨æµè§ˆå™¨å¼€å‘è€…å·¥å…·ä¸­æŸ¥çœ‹WebSocketå¸§\\n';
            status += '2. æ£€æŸ¥SUBSCRIBEå¸§çš„destination\\n';
            status += '3. æ£€æŸ¥MESSAGEå¸§çš„destination\\n';
            status += '4. ç¡®è®¤ç”¨æˆ·è®¤è¯çŠ¶æ€';

            statusDiv.textContent = status;
            statusDiv.className = 'status-display';
            log('è®¢é˜…è·¯å¾„éªŒè¯å®Œæˆ');
        }

        function checkMessageHandling() {
            const statusDiv = document.getElementById('handlingStatus');
            let status = 'æ¶ˆæ¯å¤„ç†é“¾æ£€æŸ¥:\\n\\n';

            const handlingChain = [
                {
                    step: '1. WebSocketæ¶ˆæ¯æ¥æ”¶',
                    location: 'stompClient.subscribe() callback',
                    action: 'æ¥æ”¶åŸå§‹æ¶ˆæ¯',
                    check: 'æ£€æŸ¥message.bodyæ˜¯å¦å­˜åœ¨'
                },
                {
                    step: '2. JSONè§£æ',
                    location: 'JSON.parse(message.body)',
                    action: 'è§£ææ¶ˆæ¯å†…å®¹',
                    check: 'æ£€æŸ¥è§£ææ˜¯å¦æˆåŠŸï¼Œæ•°æ®ç»“æ„æ˜¯å¦æ­£ç¡®'
                },
                {
                    step: '3. å…¨å±€storeå¤„ç†',
                    location: 'handleOrderUpdate(data)',
                    action: 'æ ¹æ®æ¶ˆæ¯ç±»å‹åˆ†å‘å¤„ç†',
                    check: 'æ£€æŸ¥data.typeæ˜¯å¦ä¸ºORDER_STATUS_CHANGE'
                },
                {
                    step: '4. çŠ¶æ€æ›´æ–°',
                    location: 'handleOrderStatusChange(data)',
                    action: 'æ›´æ–°è®¢å•çŠ¶æ€ï¼Œæ˜¾ç¤ºUIæ¶ˆæ¯',
                    check: 'æ£€æŸ¥è®¢å•IDåŒ¹é…ï¼ŒçŠ¶æ€æ›´æ–°'
                },
                {
                    step: '5. åœ°å›¾ç»„ä»¶é€šçŸ¥',
                    location: 'window.handleMapOrderUpdate(data)',
                    action: 'é€šçŸ¥åœ°å›¾ç»„ä»¶æ›´æ–°',
                    check: 'æ£€æŸ¥å…¨å±€å‡½æ•°æ˜¯å¦å­˜åœ¨å¹¶è¢«è°ƒç”¨'
                },
                {
                    step: '6. åœ°å›¾UIæ›´æ–°',
                    location: 'handleStatusChange(data) in PassengerMap.vue',
                    action: 'æ›´æ–°åœ°å›¾å…ƒç´ å’ŒUI',
                    check: 'æ£€æŸ¥åœ°å›¾å…ƒç´ æ˜¯å¦æ­£ç¡®æ›´æ–°'
                }
            ];

            handlingChain.forEach((item, index) => {
                status += `${index + 1}. ${item.step}\\n`;
                status += `   ä½ç½®: ${item.location}\\n`;
                status += `   æ“ä½œ: ${item.action}\\n`;
                status += `   æ£€æŸ¥: ${item.check}\\n\\n`;
            });

            status += 'ğŸš¨ å¸¸è§é—®é¢˜ç‚¹:\\n';
            status += '1. JSONè§£æå¤±è´¥ - æ¶ˆæ¯æ ¼å¼ä¸æ­£ç¡®\\n';
            status += '2. æ¶ˆæ¯ç±»å‹ä¸åŒ¹é… - data.type !== "ORDER_STATUS_CHANGE"\\n';
            status += '3. è®¢å•IDä¸åŒ¹é… - data.orderId !== currentOrder.id\\n';
            status += '4. å…¨å±€å‡½æ•°æœªæ³¨å†Œ - window.handleMapOrderUpdateä¸å­˜åœ¨\\n';
            status += '5. ç»„ä»¶å·²å¸è½½ - åœ°å›¾ç»„ä»¶ä¸åœ¨å½“å‰é¡µé¢\\n\\n';
            
            status += 'ğŸ”§ è°ƒè¯•å»ºè®®:\\n';
            status += '1. åœ¨æ¯ä¸ªæ­¥éª¤æ·»åŠ console.log\\n';
            status += '2. æ£€æŸ¥é”™è¯¯æ•è·å’Œå¤„ç†\\n';
            status += '3. éªŒè¯æ•°æ®æµçš„å®Œæ•´æ€§\\n';
            status += '4. ç¡®è®¤ç»„ä»¶ç”Ÿå‘½å‘¨æœŸçŠ¶æ€';

            statusDiv.textContent = status;
            statusDiv.className = 'status-display';
            log('æ¶ˆæ¯å¤„ç†é“¾æ£€æŸ¥å®Œæˆ');
        }

        function diagnoseIssues() {
            const itemsDiv = document.getElementById('diagnosisItems');
            let content = '';

            const diagnosticItems = [
                {
                    issue: 'WebSocketè¿æ¥é—®é¢˜',
                    symptoms: ['æ§åˆ¶å°æ˜¾ç¤ºè¿æ¥é”™è¯¯', 'æ— æ³•æ¥æ”¶ä»»ä½•æ¶ˆæ¯'],
                    solutions: ['æ£€æŸ¥ç½‘ç»œè¿æ¥', 'éªŒè¯WebSocketç«¯ç‚¹', 'æ£€æŸ¥è®¤è¯çŠ¶æ€'],
                    priority: 'high'
                },
                {
                    issue: 'ç”¨æˆ·IDä¸åŒ¹é…',
                    symptoms: ['æ¶ˆæ¯å‘é€ä½†æœªæ¥æ”¶', 'è®¢é˜…è·¯å¾„é”™è¯¯'],
                    solutions: ['å¯¹æ¯”å‰åç«¯ç”¨æˆ·ID', 'æ£€æŸ¥æ•°æ®ç±»å‹è½¬æ¢', 'éªŒè¯è®¢å•å½’å±'],
                    priority: 'high'
                },
                {
                    issue: 'æ¶ˆæ¯å¤„ç†é“¾æ–­è£‚',
                    symptoms: ['æ¥æ”¶åˆ°æ¶ˆæ¯ä½†UIæ— å˜åŒ–', 'éƒ¨åˆ†åŠŸèƒ½æ­£å¸¸'],
                    solutions: ['æ£€æŸ¥å…¨å±€å‡½æ•°æ³¨å†Œ', 'éªŒè¯ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ', 'æ·»åŠ é”™è¯¯å¤„ç†'],
                    priority: 'medium'
                },
                {
                    issue: 'é¡µé¢åˆ‡æ¢é—®é¢˜',
                    symptoms: ['åˆ‡æ¢é¡µé¢ååŠŸèƒ½å¤±æ•ˆ', 'é‡æ–°è¿›å…¥æ— æ•ˆæœ'],
                    solutions: ['æ£€æŸ¥ç»„ä»¶å¸è½½æ¸…ç†', 'éªŒè¯é‡æ–°æ³¨å†Œé€»è¾‘', 'ç¡®è®¤çŠ¶æ€æ¢å¤'],
                    priority: 'medium'
                },
                {
                    issue: 'æ—¶åºé—®é¢˜',
                    symptoms: ['å¶å°”æ­£å¸¸å¶å°”å¤±æ•ˆ', 'åˆ·æ–°åæ­£å¸¸'],
                    solutions: ['æ£€æŸ¥åˆå§‹åŒ–é¡ºåº', 'æ·»åŠ å»¶è¿Ÿå¤„ç†', 'ç¡®è®¤å¼‚æ­¥æ“ä½œ'],
                    priority: 'low'
                }
            ];

            diagnosticItems.forEach(item => {
                const priorityColor = item.priority === 'high' ? '#f44336' : 
                                    item.priority === 'medium' ? '#ff9800' : '#4caf50';
                
                content += `<div style="border-left: 4px solid ${priorityColor}; padding: 10px; margin: 10px 0; background: #f9f9f9;">
                    <h4 style="margin: 0 0 10px 0; color: ${priorityColor};">
                        ${item.issue} (${item.priority.toUpperCase()})
                    </h4>
                    <div><strong>ç—‡çŠ¶:</strong> ${item.symptoms.join(', ')}</div>
                    <div><strong>è§£å†³æ–¹æ¡ˆ:</strong> ${item.solutions.join(', ')}</div>
                </div>`;
            });

            content += `<div style="background: #e3f2fd; padding: 15px; border-radius: 5px; margin-top: 20px;">
                <h4>ğŸ¯ æ¨èè°ƒè¯•æ­¥éª¤:</h4>
                <ol>
                    <li>åœ¨æµè§ˆå™¨æ§åˆ¶å°æŸ¥çœ‹WebSocketè¿æ¥çŠ¶æ€å’Œæ¶ˆæ¯</li>
                    <li>åœ¨å‰ç«¯æ·»åŠ è¯¦ç»†çš„æ—¥å¿—è¾“å‡º</li>
                    <li>åœ¨åç«¯æ·»åŠ æ¶ˆæ¯å‘é€æ—¥å¿—</li>
                    <li>ä½¿ç”¨WebSocketè°ƒè¯•å·¥å…·ç›‘æ§æ¶ˆæ¯æµ</li>
                    <li>é€æ­¥éªŒè¯æ¶ˆæ¯å¤„ç†é“¾çš„æ¯ä¸ªç¯èŠ‚</li>
                </ol>
            </div>`;

            itemsDiv.innerHTML = content;
            log('é—®é¢˜è¯Šæ–­å®Œæˆ');
        }

        function simulateReconnect() {
            log('æ¨¡æ‹ŸWebSocketé‡è¿...');
            
            setTimeout(() => {
                log('WebSocketé‡è¿å®Œæˆ');
                checkWebSocketStatus();
            }, 2000);
        }

        // é¡µé¢åŠ è½½æ—¶çš„åˆå§‹åŒ–
        window.onload = function() {
            log('æ¶ˆæ¯æµè°ƒè¯•å·¥å…·å·²åŠ è½½');
            
            log('è°ƒè¯•ç›®æ ‡: è§£å†³ä¹˜å®¢ç«¯æ¥æ”¶ä¸åˆ°å¸æœºçŠ¶æ€å˜åŒ–æ¶ˆæ¯çš„é—®é¢˜');
            log('ä¸»è¦æ£€æŸ¥ç‚¹: WebSocketè¿æ¥ã€ç”¨æˆ·IDåŒ¹é…ã€æ¶ˆæ¯å¤„ç†é“¾');
        };
    </script>
</body>
</html>"