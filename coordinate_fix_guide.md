# ðŸ”§ ç»çº¬åº¦å­—æ®µåå’Œæ•°å€¼ä¿®å¤æŒ‡å—

## é—®é¢˜åˆ†æž

ä½ çš„è¾“å…¥æ•°æ®å­˜åœ¨ä¸¤ä¸ªé—®é¢˜ï¼š
1. **å­—æ®µåå’Œå€¼ä¸åŒ¹é…**ï¼šlatitudeå­—æ®µå­˜å‚¨äº†ç»åº¦å€¼ï¼Œlongitudeå­—æ®µå­˜å‚¨äº†çº¬åº¦å€¼
2. **å‰ç«¯å¯èƒ½ä¼ å‚é”™è¯¯**ï¼šåœ¨è°ƒç”¨APIæ—¶å°±å·²ç»æŠŠå‚æ•°æžåäº†

## å½“å‰é”™è¯¯çŠ¶æ€

### ä½ çš„è¾“å…¥
```json
{
  "driverId": 1,
  "latitude": 116.4540,   // âŒ å­—æ®µåæ˜¯latitudeï¼Œä½†å€¼æ˜¯ç»åº¦
  "longitude": 39.9340    // âŒ å­—æ®µåæ˜¯longitudeï¼Œä½†å€¼æ˜¯çº¬åº¦
}
```

### æ•°æ®åº“å­˜å‚¨ç»“æžœ
```
currentLatitude = 116.4540   // âŒ çº¬åº¦å­—æ®µå­˜å‚¨äº†ç»åº¦å€¼
currentLongitude = 39.9340   // âŒ ç»åº¦å­—æ®µå­˜å‚¨äº†çº¬åº¦å€¼
```

## ðŸŽ¯ æ­£ç¡®çš„åº”è¯¥æ˜¯

### æ­£ç¡®è¾“å…¥
```json
{
  "driverId": 1,
  "latitude": 39.9340,    // âœ… çº¬åº¦å­—æ®µå­˜å‚¨çº¬åº¦å€¼
  "longitude": 116.4540   // âœ… ç»åº¦å­—æ®µå­˜å‚¨ç»åº¦å€¼
}
```

### æ­£ç¡®çš„æ•°æ®åº“å­˜å‚¨
```
currentLatitude = 39.9340    // âœ… çº¬åº¦å­—æ®µå­˜å‚¨çº¬åº¦å€¼
currentLongitude = 116.4540  // âœ… ç»åº¦å­—æ®µå­˜å‚¨ç»åº¦å€¼
```

## ðŸ” æ£€æŸ¥æ¸…å•

### 1. æ£€æŸ¥å‰ç«¯ä»£ç 
æŸ¥çœ‹ä½ çš„å‰ç«¯JavaScriptä»£ç ï¼Œç¡®ä¿ï¼š
```javascript
// âŒ é”™è¯¯çš„è°ƒç”¨æ–¹å¼
const wrongData = {
    latitude: longitude,   // æŠŠç»åº¦èµ‹å€¼ç»™äº†latitude
    longitude: latitude    // æŠŠçº¬åº¦èµ‹å€¼ç»™äº†longitude
};

// âœ… æ­£ç¡®çš„è°ƒç”¨æ–¹å¼
const correctData = {
    latitude: latitude,    // çº¬åº¦èµ‹å€¼ç»™latitude
    longitude: longitude   // ç»åº¦èµ‹å€¼ç»™longitude
};
```

### 2. æ£€æŸ¥APIè°ƒç”¨
ç¡®ä¿Apifoxæˆ–å…¶ä»–APIå·¥å…·ä¸­çš„å‚æ•°æ­£ç¡®ï¼š
```
âŒ é”™è¯¯ï¼š
POST /api/drivers/1/online?latitude=116.4540&longitude=39.9340

âœ… æ­£ç¡®ï¼š
POST /api/drivers/1/online?latitude=39.9340&longitude=116.4540
```

### 3. æ£€æŸ¥åœ°å›¾APIèŽ·å–åæ ‡çš„ä»£ç 
å¦‚æžœä½ ä½¿ç”¨åœ°å›¾APIèŽ·å–åæ ‡ï¼Œç¡®ä¿ï¼š
```javascript
// ä¸åŒåœ°å›¾APIè¿”å›žæ ¼å¼å¯èƒ½ä¸åŒ
// ç™¾åº¦åœ°å›¾
const baiduResult = {
    lat: 39.9340,  // çº¬åº¦
    lng: 116.4540  // ç»åº¦
};

// é«˜å¾·åœ°å›¾
const gaodeResult = {
    latitude: 39.9340,   // çº¬åº¦
    longitude: 116.4540  // ç»åº¦
};

// ç¡®ä¿æ­£ç¡®æ˜ å°„åˆ°ä½ çš„APIå‚æ•°
const apiParams = {
    latitude: baiduResult.lat,    // æˆ– gaodeResult.latitude
    longitude: baiduResult.lng    // æˆ– gaodeResult.longitude
};
```

## ðŸ› ï¸ ä¿®å¤æ­¥éª¤

### æ­¥éª¤1: æ¸…ç†é”™è¯¯æ•°æ®
```sql
-- æŸ¥çœ‹å½“å‰é”™è¯¯æ•°æ®
SELECT id, current_latitude, current_longitude 
FROM drivers 
WHERE current_latitude > 100;  -- çº¬åº¦ä¸åº”è¯¥è¶…è¿‡100

-- å¦‚æžœç¡®è®¤æ•°æ®é”™è¯¯ï¼Œäº¤æ¢ç»çº¬åº¦
UPDATE drivers 
SET 
    current_latitude = current_longitude,
    current_longitude = current_latitude,
    updated_at = NOW()
WHERE current_latitude > 100 AND current_longitude < 100;
```

### æ­¥éª¤2: ä¿®å¤å‰ç«¯ä»£ç 
æ£€æŸ¥å¹¶ä¿®å¤ä½ çš„å‰ç«¯ä»£ç ä¸­çš„åæ ‡èŽ·å–å’Œä¼ é€’é€»è¾‘ã€‚

### æ­¥éª¤3: é‡æ–°æµ‹è¯•
ä½¿ç”¨æ­£ç¡®çš„åæ ‡é‡æ–°æµ‹è¯•æ‰€æœ‰åŠŸèƒ½ã€‚

## ðŸ“ åŒ—äº¬åœ°åŒºæµ‹è¯•åæ ‡

```json
{
  "å¤©å®‰é—¨å¹¿åœº": { "latitude": 39.9042, "longitude": 116.4074 },
  "è¥¿å•å•†ä¸šåŒº": { "latitude": 39.9163, "longitude": 116.3972 },
  "é¸Ÿå·¢ä½“è‚²åœº": { "latitude": 39.9928, "longitude": 116.3906 },
  "é¢å’Œå›­": { "latitude": 39.9999, "longitude": 116.2750 },
  "åŒ—äº¬å¤§å­¦": { "latitude": 39.9990, "longitude": 116.3059 }
}
```

## ðŸ§­ è®°å¿†æŠ€å·§

- **Latitude** = **çº¬åº¦** = **å—åŒ—** = åŒ—äº¬çº¦ **39.xx**
- **Longitude** = **ç»åº¦** = **ä¸œè¥¿** = åŒ—äº¬çº¦ **116.xx**
- **çº¬åº¦èŒƒå›´**: 39.4 - 41.0 (åŒ—äº¬åœ°åŒº)
- **ç»åº¦èŒƒå›´**: 115.4 - 117.5 (åŒ—äº¬åœ°åŒº)

## âš ï¸ å¸¸è§é”™è¯¯æ¥æº

1. **åœ°å›¾APIè¿”å›žæ ¼å¼æ··æ·†**
2. **å‰ç«¯å˜é‡åä½¿ç”¨é”™è¯¯**
3. **å¤åˆ¶ç²˜è´´æ—¶é¡ºåºæžå**
4. **ä¸åŒåæ ‡ç³»è½¬æ¢é”™è¯¯**
5. **æµ‹è¯•æ•°æ®éšæ„å¡«å†™**

è®°ä½ï¼š**çº¬åº¦å°ç»åº¦å¤§**ï¼ˆåŒ—äº¬åœ°åŒºï¼šçº¬åº¦39.xx < ç»åº¦116.xxï¼‰